/**基于Layui的分页组件  2017/8/8  version 1.0.01*/
;(function($){$.fn.extend({"PaginBar":function(divId,table,selectFrom,rowsSize,pageIndex,url,addhtml){var divId=$("#"+divId+"");var tableId=$("#"+table+"");var fromId=$("#"+selectFrom+"");var url=url;var rowsSize=rowsSize;var pageIndex=pageIndex;var count=0;var paramData={};var addHtmlMthod=addhtml;var pageTotal=0;var layerIndex;var layer;queryPageCount=function(){var rows=rowsSize;var curr=pageIndex;paramData.rowsSize=rows;paramData.pageIndex=curr;var p=$.post(url,paramData,function(json){if(json.errorcode==0){count=json.data.total;pageTotal=Math.ceil(count/rows);innerPageHtml();setCurrPageHtml(curr);var html=addHtmlMthod(json);tableId.html(html);if(curr>1){scrollTop()}unselectCheack();layui.use(["laypage","layer"],function(){var laypage=layui.laypage,layer=layui.layer;laypage({cont:divId,pages:pageTotal,skip:true,skin:"#009688",curr:this.pageIndex,jump:function(obj,first){if(first){return}openLoad();var curr=obj.curr;var rows=rowsSize;paramData.rowsSize=rows;paramData.pageIndex=curr;var p=$.post(url,paramData,function(json){if(json.errorcode==0){setCurrPageHtml(curr);var html=addHtmlMthod(json);tableId.html(html);if(curr>1){scrollTop()}unselectCheack()}else{layer.alert("未查询到相关数据!!")}closeLoad()},"json");p.error(function(){closeLoad();layer.alert("加载数据失败请重试!!")})}})})}else{layer.alert("未查询到相关数据!!")}},"json");p.error(function(){closeLoad();layer.alert("加载数据失败请重试!!")})},openLoad=function(){layui.use("layer",function(){var $=layui.jquery;layer=layui.layer;layerIndex=layer.open({type:3,shade:0.2,icon:2,time:10000})})},unselectCheack=function(){if($("#all").length>0){$("#all").prop("checked",false)}},closeLoad=function(){if(layerIndex!=undefined){layer.close(layerIndex)}},scrollTop=function(){$("html, body").animate({scrollTop:130},"fast")},resetFrom=function(){$("#"+selectFrom+"")[0].reset()},innerPageHtml=function(){$("#currPage").html(pageIndex);$("#totalPage").html(pageTotal);$("#totalRows").html(count);$("#rows").html(rowsSize)},setCurrPageHtml=function(curr){$("#currPage").html(curr)},termQueryPage=function(){paramData={};var fromData=fromId.serializeArray();$.each(fromData,function(){var d=paramData[this.name];if(d!=undefined&&d!=""){if(this.value!=undefined&&this.value!=""&&this.value!=0){paramData[this.name]=this.value}else{delete paramData[this.name]}}else{if(this.value!=undefined&&this.value!=""&&this.value!=0){paramData[this.name]=this.value}}});queryPageCount()}}})}(jQuery));